<!DOCTYPE html>
<html>
<head>
<title>Time Broadcaster</title>
</head>
<body>
  <div id="app"></div>
  <script src="timeserver-elm.js"></script>
  <script type="module" src="index.js"></script>
  <script>

    const app = Elm.TimeServer.init({
      node: document.getElementById('app'),
    });
    const timeChannel = new BroadcastChannel('time_channel');

    timeChannel.onmessage = (event) => {
      if (event.data === 'request_time') {
        const currentTime = new Date().toLocaleTimeString();
        timeChannel.postMessage(currentTime);
        console.log("Broadcasted time:", currentTime);
      }
    };
  </script>
</body>
</html>